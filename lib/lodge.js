"use strict";function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}window.lodge||(window.lodge=function a(){var a={embedded:!1,eventlist:{},get:{},lightbox:!1,loaded:!1,name:"",options:"",parent:"",path:"",scripts:[],storage:{},templates:{},_constructor:function _constructor(){var b=window.lodge,c=document.querySelector("script[src$=\"lodge.js\"]");if(c&&(b.path=c.src.substr(0,c.src.length-9),a.options=c.getAttribute("data-options")+""),b._findEmbeds(),b.get.qs=window.location.search.substring(1),b.get.params=!1,b.get.qs){b.get.params={};for(var d,e=b.get.qs.split("&"),f=0;f<e.length;f++)d=e[f].split("="),b.get.params[d[0]]=decodeURIComponent(d[1])}if(b.get.params.debug&&(b.debug.show=!0),self!==top){if(-1!==b.options.indexOf("noembed"))return!1;b.styles.addClass({el:document.documentElement,className:"vv-embed"}),b._initEmbed()}else b.name="main window";b.get.params.modal&&b.styles.addClass({el:document.documentElement,className:"vv-modal"});var g=document.querySelectorAll("a.lodge.gallery,div.lodge.gallery");(-1!==b.options.indexOf("lightboxvideo")||0<g.length)&&b.getScript({url:"".concat(b.path,"/lightbox/lightbox.js")}),window.addEventListener("message",function(a){-1!==b.embeds.allowed.indexOf(a.origin)&&b._handleMessage(a)}),b.embeds.allowed+=window.location.href.split("/").slice(0,3).join("/"),b.get.params.location&&(b.embeds.allowed+=b.get.params.location.split("/").slice(0,3).join("/")),b.embedded||b.overlay.create(),b.loaded=Date.now(),b._drawQueuedEmbeds(),b.debug.out({message:"finished initializing",obj:b}),b.events.fire({obj:b,type:"ready",data:b.loaded})},_findEmbeds:function _findEmbeds(){var b=document.querySelectorAll("embed.lodge");if("object"===_typeof(b)){var c=Array.prototype.slice.call(b);c.forEach(function(b){b.style.height="1px",b.style.visibility="hidden";var c=b.getAttribute("src"),d=b.getAttribute("title"),e=b.getAttribute("data-css"),f=b.getAttribute("id"),g=a.styles.hasClass({el:b,className:"modal"}),h=a.styles.hasClass({el:b,className:"forwardquery"});c&&a.embeds.create({src:c,alt:d,target:b,css:e,id:f,modal:g,forwardquery:h})})}},_drawQueuedEmbeds:function _drawQueuedEmbeds(){var a=window.lodge;"object"===_typeof(a.storage.elementQueue)&&a.storage.elementQueue.forEach(function(b){a.embeds.create(b)})},_initEmbed:function _initEmbed(){var a=window.lodge;a.embedded=!0,a.get.params.lodgelocation&&(a.parent=a.get.params.lodgelocation,a.embeds.allowed="".concat(a.embeds.allowed,",").concat(a.parent)),a.name=a.get.params.name?a.get.params.name:window.location,a.get.params.cssoverride&&a.styles.injectCSS({css:a.get.params.cssoverride,important:!0}),a.get.params.fixedsize||(a.storage.embedheight=a.measure.scrollheight(),a.events.fire({obj:a,type:"resize",data:{height:a.storage.embedheight}}),window.setInterval(function(){var b=a.measure.scrollheight();b!==a.storage.embedheight&&(a.storage.embedheight=b,a.events.fire({obj:a,type:"resize",data:{height:b}}))},250))},_handleMessage:function _handleMessage(a){var b=window.lodge,c=JSON.parse(a.data),d={addclass:{handler:"styles.addClass"},begincheckout:{handler:"checkout.begin",require:"checkout/checkout.js"},injectcss:{handler:"styles.injectCSS"},overlayhide:{handler:"overlay.hide"},overlayreveal:{handler:"overlay.reveal"},overlaysetloading:{handler:"overlay.setLoading"},removeclass:{handler:"styles.removeClass"},resize:{handler:"embeds.resize"},swapclasses:{handler:"styles.swapClasses"}},e=!0;try{for(var j=0;j<b.embeds.all.length;j++)if(b.embeds.all[j].el.contentWindow===a.source){b.embeds.all[j].el.source||(b.embeds.all[j].source=a.source),c.data._source=b.embeds.all[j];break}}catch(a){e=!1}if(e)if(d[c.type]){var f=d[c.type].handler.split("."),g=f.pop(),h=b;f.length&&(h=b[f[0]]),d[c.type].require?b.getScript({url:"".concat(b.path,"/").concat(d[c.type].require),callback:function(){h[g](c.data)}}):h[g](c.data)}else"ready"!==c.type&&b.events.fire({obj:b,type:c.type,data:c.data,target:!1,localonly:!0})},getTemplate:function getTemplate(a){var b=a.templateName,c=a.successCallback,d=a.loadCSS,e=window.lodge,f=e.templates;if(void 0!==f[b])c(f[b]);else if(this.ajax.jsonp({url:"".concat(e.path,"/templates/").concat(b,".js"),callback:function(a){f[b]=a.template,c(a.template)},remoteCallback:"_".concat(b,"Callback")}),void 0===d||d){var g=document.querySelectorAll("link[href=\"".concat(e.path,"/templates/").concat(b,".css\"]"));g.length||e.styles.injectCSS({css:"".concat(e.path,"/templates/").concat(b,".css")})}},getScript:function getScript(a){var b=a.url,c=a.callback,d=window.lodge;if(-1<d.scripts.indexOf(b))"function"==typeof c&&c();else{d.scripts.push(b);var e=document.getElementsByTagName("head")[0]||document.documentElement,f=document.createElement("script");f.src=b;var g=!1;f.onload=f.onreadystatechange=function(){g||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(g=!0,"function"==typeof c&&c(),f.onload=f.onreadystatechange=null,e&&f.parentNode&&e.removeChild(f))},e.insertBefore(f,e.firstChild)}d.debug.out({message:"loaded script: ".concat(b)})},embeds:{allowed:"",all:[],create:function create(a){var b,c=a.src,d=a.alt,e=void 0===d?"open":d,f=a.target,g=a.css,h=a.id,i=a.modal,j=void 0!==i&&i,k=a.forwardquery,l=void 0!==k&&k,m=window.lodge;if(!m.loaded)"object"!==_typeof(m.storage.elementQueue)&&(m.storage.elementQueue=[]),m.storage.elementQueue.push({src:c,alt:e,target:f,css:g,id:h,modal:j,forwardquery:l});else{b="string"==typeof targetNode?document.querySelector(f):f;var n=m.embeds.buildIframe({src:c,css:g,modal:j,id:h,forwardquery:l});if(b){if(j){var o=document.createElement("span");o.className="vv-modalopen",m.overlay.create(function(){var c=document.createElement("a");c.href="",c.target="_blank",c.innerHTML=e,o.appendChild(c),b.parentNode.insertBefore(o,b),function(){c.addEventListener("click",function(a){return m.overlay.reveal({innerContent:n}),a.preventDefault(),!1})}()})}else b.parentNode.insertBefore(n,b);"EMBED"===b.tagName&&b.parentNode.removeChild(b)}}},buildIframe:function buildIframe(a){var b=a.src,c=a.css,d=a.modal,e=a.id,f=a.forwardquery,g=window.lodge,h=document.createElement("iframe"),i=b,j=encodeURIComponent("".concat(location.protocol,"//").concat(location.hostname).concat(location.port?":".concat(location.port):""));e||(e="vv-".concat(new Date().getTime())),i+="?lodgelocation=".concat(j),c&&(i+="&cssoverride=".concat(encodeURIComponent(c))),void 0!==f&&f&&(i+="&".concat(g.get.qs)),d&&(i+="&modal=1"),g.debug.show&&(i+="&name=".concat(e)),i+="&".concat(g.get.qs),h.src=i,h.id=e,h.className="vv-embed",h.style.width="100%",h.style.height="0",h.style.border="0",h.style.overflow="hidden",h.scrolling="no";var k=window.location;return i.includes("://")&&(k=i.split("/").slice(0,3).join("/"),-1===g.embeds.allowed.indexOf(k)&&(g.embeds.allowed+=",".concat(k))),g.embeds.all.push({id:e,el:h,src:b,source:null,origin:k}),g.debug.out({message:"building iframe for ".concat(e)}),h},resize:function resize(a){var b=a._source,c=a.height,d=b.el;d.height=c,d.style.height="".concat(c,"px")},getById:function getById(a){for(var b=window.lodge,c=!1,d=0;d<b.embeds.all.length;d++)if(b.embeds.all[d].id===a){c=b.embeds.all[d];break}return c}},debug:{show:!1,store:function store(a){var b=a.message,c=a.obj,d=window.lodge;d.storage.debug||(d.storage.debug=[]),d.storage.debug.push({message:b,obj:c})},out:function out(a){var b=a.message,c=a.obj,d=window.lodge;if(d.debug.show){if(!d.loaded)return void d.debug.store({message:b,obj:c});var e={main:{logo:"color:#093;font-weight:bold;",name:"color:#093;font-weight:bold;",message:"font-weight:normal;"},embed:{logo:"color:#69f;font-weight:bold;",name:"color:#69f;font-weight:bold;",message:"font-weight:normal;"}},f="main",g="\u25B3\u25B3";d.embedded&&(f="embed",g="\u25BD\u25BD"),d.storage.debug?(console.groupCollapsed("%c".concat(g,"%c ").concat(d.name,":%c\n   ").concat(b),e[f].logo,e[f].name,e[f].message),c&&console.log("   attachment: %O",c),d.storage.debug.forEach(function(a){a.o?console.log("   ".concat(a.message," %O"),a.obj):console.log("   ".concat(a.message))}),console.groupEnd(),delete d.storage.debug):c?console.log("%c".concat(g,"%c ").concat(d.name,":%c\n   ").concat(b," %O"),e[f].logo,e[f].name,e[f].message,c):console.log("%c".concat(g,"%c ").concat(d.name,":%c\n   ").concat(b),e[f].logo,e[f].name,e[f].message)}}},ajax:{send:function send(a){var b=a.url,c=a.postString,d=a.successCallback,e=a.failureCallback,f=void 0!==e&&e,g="POST",h=new XMLHttpRequest;h&&(h.open(g,b,!0),h.setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"===g&&h.setRequestHeader("Content-type","application/x-www-form-urlencoded"),"function"==typeof d&&(h.onreadystatechange=function(){4===h.readyState&&(200===h.status?d(h.responseText):"function"==typeof f&&f(h.responseText))}),h.send(void 0!==c&&c))},jsonp:function jsonp(a){var b=a.url,c=a.callback,d=a.remoteCallback,e=void 0===d?"callback":d;window[e]=function(a){c(a),delete window[e]};var f=document.createElement("script");f.setAttribute("src",b),document.getElementsByTagName("head")[0].appendChild(f)},encodeForm:function encodeForm(a){if("object"!==_typeof(a))return!1;var b="";a=a.elements||a;for(var c=0;c<a.length;c++){if("checkbox"===a[c].type||"radio"===a[c].type){a[c].checked&&(b+="".concat((b.length?"&":"")+a[c].name,"=").concat(a[c].value));continue}b+="".concat((b.length?"&":"")+a[c].name,"=").concat(a[c].value)}return encodeURI(b)}},addEventListener:function addEventListener(a,b){var c=window.lodge;c.events.addListener(a,b)},removeEventListener:function removeEventListener(a,b){var c=window.lodge;c.events.removeListener(a,b)},dispatchEvent:function dispatchEvent(a){var b=window.lodge;b.events.dispatch(a)},events:{fire:function fire(a){var b=a.obj,c=a.type,d=a.data,f=void 0===d?"":d,g=a.target,h=a.localonly,i=window.lodge;if(g)"string"==typeof g?g=i.embeds.getById(g):(!g.source||!g.origin)&&(g=!1),g&&g.source.postMessage(JSON.stringify({type:c,data:f}),g.origin),i.debug.out({message:"targeted ".concat(g.id," with ").concat(c," event."),obj:f});else{var j=null;document.dispatchEvent?(j=document.createEvent("CustomEvent"),j.initCustomEvent(c,!1,!1,f),i.embedded&&!h&&(j.relay=!0,j.source=window,j.origin=window.location.origin),b.dispatchEvent(j)):(j=document.createEventObject(),j.detail=f,i.embedded&&!h&&(j.relay=!0,j.source=window,j.origin=window.location.origin),b.fireEvent("on".concat(c),j)),j.relay&&i.events.relay({type:c,data:f});var e="firing ";j.relay&&(e="relaying "),i.debug.out({message:"".concat(e+c," event."),obj:f})}},relay:function relay(a){var b=a.type,c=a.data,d=window.lodge,e="*";d.parent&&(e=d.parent),window.parent.postMessage(JSON.stringify({relay:!0,type:b,data:c}),e)},addListener:function addListener(a,b){var c=window.lodge;c.eventlist.hasOwnProperty(a)||(c.eventlist[a]=[]),c.eventlist[a].push(b)},removeListener:function removeListener(a,b){var c=window.lodge;if(c.eventlist.hasOwnProperty(a)){var d=c.eventlist[a].indexOf(b);-1!==d&&c.eventlist[a].splice(d,1)}},dispatch:function dispatch(a){var b=window.lodge;if(b.eventlist.hasOwnProperty(a.type)){var c;for(c=0;c<b.eventlist[a.type].length;c++)b.eventlist[a.type][c]&&b.eventlist[a.type][c](a)}}},measure:{viewport:function viewport(){return{x:window.innerWidth||document.body.offsetWidth||0,y:window.innerHeight||document.body.offsetHeight||0}},scrollheight:function scrollheight(){var a=Math.max,b=document.body,c=document.documentElement;return a(b.scrollHeight,c.scrollHeight,b.offsetHeight,c.offsetHeight,b.clientHeight,c.clientHeight)}},validate:{email:function email(a){return /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test((a+"").toLowerCase())}},overlay:{content:!1,close:!1,loadingContent:!1,callbacks:[],setLoading:function setLoading(a){var b=a.loadString,c=window.lodge;c.overlay.loadingContent=b.toString(),c.embedded&&c.events.fire({obj:c,type:"overlaysetloading",data:{loadString:c.overlay.loadingContent}})},showLoading:function showLoading(){var a=window.lodge;a.overlay.loadingContent&&a.overlay.reveal({innerContent:a.overlay.loadingContent})},create:function create(a){var b=window.lodge,c=b.overlay;b.styles.injectCSS({css:"".concat(b.path,"/templates/overlay.css")}),c.content=document.createElement("div"),c.content.className="vv-overlay",c.close=document.createElement("div"),c.close.className="vv-close",window.addEventListener("keyup",function(a){27===a.keyCode&&c.content.parentNode===document.body&&c.hide()}),c.close.addEventListener("click",function(){c.content.parentNode===document.body&&c.hide()}),"function"==typeof a&&a()},hide:function hide(){var a=window.lodge,b=a.overlay,c=document.body;if(a.embedded)a.events.fire({obj:a,type:"overlayhide"});else{for(b.content.style.opacity=0,a.events.fire({obj:a,type:"overlayhidden"});b.content.firstChild;)b.content.removeChild(b.content.firstChild);c.removeChild(b.close),c.removeChild(b.content);var d=document.querySelectorAll(".vv-overlaytrigger");if(0<d.length)for(var e=0,f=d.length;e<f;e++)d[e].style.visibility="visible";a.styles.removeClass({el:document.documentElement,className:"vv-noscroll"})}},reveal:function reveal(a){var b=a.innerContent,c=a.wrapClass,d=void 0===c?"vv-component":c,e=window.lodge,f=e.overlay,g=document.body,h=document.createElement("div"),i=document.createElement("div");e.embedded?e.events.fire({obj:e,type:"overlayreveal",data:{innerContent:b,wrapClass:d}}):(1===f.content.style.opacity&&(f.content.innerHTML=""),h.className="vv-position",i.className=d,"string"==typeof b?i.innerHTML=b:i.appendChild(b),h.appendChild(i),f.content.appendChild(h),!e.styles.hasClass({el:document.documentElement,className:"vv-noscroll"})&&e.styles.addClass({el:document.documentElement,className:"vv-noscroll"}),1!==f.content.style.opacity&&(f.content.style.opacity=0,g.appendChild(f.content),g.appendChild(f.close),window.getComputedStyle(f.content).opacity,f.content.style.opacity=1,e.events.fire({obj:e,type:"overlayrevealed"})))}},styles:{resolveElement:function resolveElement(a){return"string"==typeof a?"storage:"===a.substr(0,8)?window.lodge.storage[a.substr(8)]:document.querySelector(a):a},addClass:function addClass(a){var b=a.el,c=a.className,d=a.top,e=window.lodge;void 0!==d&&d&&e.embedded?e.events.fire({obj:e,type:"addclass",data:{el:b,className:c}}):(b=e.styles.resolveElement(b),b&&!e.styles.hasClass({el:b,className:c})&&(b.className="".concat(b.className," ").concat(c)))},hasClass:function hasClass(a){var b=a.el,c=a.className,d=window.lodge;return b=d.styles.resolveElement(b),-1<" ".concat(b.className," ").indexOf(" ".concat(c," "))},injectCSS:function injectCSS(a){var b,c=a.css,d=a.important,e=void 0!==d&&d,f=a.top,g=window.lodge;if(void 0!==f&&f&&g.embedded)g.events.fire({obj:g,type:"injectcss",data:{css:c,important:e}});else{var h=document.getElementsByTagName("head")[0]||document.documentElement;"http"===c.substr(0,4)?(b=document.createElement("link"),b.rel="stylesheet",b.href=c):(b=document.createElement("style"),b.innerHTML=c),b.type="text/css",e?h.appendChild(b):h.insertBefore(b,h.firstChild)}},removeClass:function removeClass(a){var b=a.el,c=a.className,d=a.top,e=window.lodge;void 0!==d&&d&&e.embedded?e.events.fire({obj:e,type:"removeclass",data:{el:b,className:c}}):(b=e.styles.resolveElement(b),b&&(b.className=" ".concat(b.className," ").replace(" ".concat(c," ")," ").replace(/^\s+/,"").replace(/\s+$/,"")))},swapClasses:function swapClasses(a){var b=a.el,c=a.oldClass,d=a.newClass,e=a.top,f=window.lodge;void 0!==e&&e&&f.embedded?f.events.fire({obj:f,type:"swapclasses",data:{el:b,oldClass:c,newClass:d}}):(b=f.styles.resolveElement(b),b&&(b.className=" ".concat(b.className," ").replace(" ".concat(c," ")," ".concat(d," ")).replace(/^\s+/,"").replace(/\s+$/,"")))}}};return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",a._constructor):a._constructor(),a}());