"use strict";function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}(function(){'use strict';var a=window.lodge;a.stripe={eventAttached:!1,getYears:function getYears(){for(var a=new Date().getFullYear(),b={},c=0;20>c;c++)b[a]=a,a++;return b},generateToken:function generateToken(a,b){var c=window.lodge;c.embedded?c.events.fire(c,"stripetokenrequested",params):c.loadScript("https://js.stripe.com/v2/",function(){var d=[];d.push({id:"name",type:"text",placeholder:"Cardholder name"}),d.push({id:"email",type:"email",placeholder:"Email address"}),d.push({id:"card-number",type:"text",placeholder:"Credit card number"}),d.push({id:"card-expiry-month",type:"select",options:{"01":"01: Jan","02":"02: Feb","03":"03: Mar","04":"04: Apr","05":"05: May","06":"06: Jun","07":"07: Jul","08":"08: Aug","09":"09: Sep",10:"10: Oct",11:"11: Nov",12:"12: Dec"},value:"01"}),d.push({id:"card-expiry-year",type:"select",options:c.stripe.getYears(),placeholder:new Date().getFullYear()}),d.push({id:"card-cvc",type:"text",placeholder:"CVV"}),d.push({id:"stripe-submit",type:"submit",text:"Submit Payment"}),c.userinput.getInput(d,"getstripetoken",null,""),c.stripe.eventAttached||(c.events.add(c,"userinput",function(d){"getstripetoken"==d.detail["vv-userinput-type"]&&(Stripe.setPublishableKey(a),Stripe.card.createToken({name:d.detail.name,number:d.detail["card-number"],cvc:d.detail["card-cvc"],exp_month:d.detail["card-expiry-month"],exp_year:d.detail["card-expiry-year"]},function(a,e){e.error?(document.getElementById("vv-userinput-message").innerHTML=e.error.message,c.styles.addClass(document.getElementsByClassName("vv-userinput-container")[0],"nope"),setTimeout(function(){c.styles.removeClass(document.getElementsByClassName("vv-userinput-container")[0],"nope")},800)):(c.storage.checkoutdata.stripe=e.id,c.storage.checkoutdata.name=d.detail.name,c.storage.checkoutdata.email=d.detail.email,c.events.fire(c,"checkoutdata",c.storage.checkoutdata,b),c.overlay.reveal("<div class=\"vv-loading\"></div>"))}))}),c.stripe.eventAttached=!0)})}},a.userinput={getInput:function getInput(b,c,d,e){c=c||"unknown";var f=document.createElement("form"),g=document.createElement("div");g.className="vv-userinput-container";var h=document.createElement("div");h.id="vv-userinput-message",h.innerHTML="&nbsp;",e&&(h.innerHTML=e),f.className="vv-userinput "+c+" "+d,b.push({id:"vv-userinput-type",type:"hidden",value:c});for(var j,k=0;k<b.length;k++){if(j=b[k],"submit"!==j.type&&"select"!==j.type){var l=document.createElement("input");l.type=j.type,l.placeholder=j.placeholder,j.value&&(l.value=j.value)}else if("select"==j.type){var l=document.createElement("select"),m=Object.keys(j.options);m.sort(function(c,a){return c-a});for(var o,p=0;p<m.length;p++)o=document.createElement("option"),o.value=m[p],o.text=j.options[m[p]],j.value==m[p]&&(o.selected="selected"),l.appendChild(o)}else{var l=document.createElement("button");l.type="submit",l.innerHTML=j.text}if(l.name=j.id,l.id="vv-userinput-"+c+"-"+j.id,j.required&&l.setAttribute("data-required","1"),"stripe-submit"==j.id&&a.storage.checkoutdata.total){var q=document.createElement("div");q.id="vv-amount-message",a.storage.checkoutdata.transaction_message||(a.storage.checkoutdata.transaction_message=""),q.innerHTML="<h2 class=\"vv-pricing\">Transaction amount: <span>"+a.storage.checkoutdata.total+a.storage.checkoutdata.transaction_message+"</span></h2><!--vv-pricing-->",f.appendChild(q)}f.appendChild(l)}g.appendChild(h),g.appendChild(f),a.events.add(f,"submit",function(b){b.preventDefault(),b.stopPropagation();for(var b,c={},d=!1,g=0;g<f.elements.length;g++)b=f.elements[g],c[b.name]=b.value,b.getAttribute("data-required")&&""==b.value?(d=!0,a.styles.addClass(b,"incomplete")):a.styles.removeClass(b,"incomplete");d?(document.getElementById("vv-userinput-message").innerHTML="Please complete all required fields.",a.styles.addClass(document.getElementsByClassName("vv-userinput-container")[0],"nope"),setTimeout(function(){a.styles.removeClass(document.getElementsByClassName("vv-userinput-container")[0],"nope")},800)):a.events.fire(a,"userinput",c)}),a.overlay.reveal(g)}},a.checkout={prepped:!1,countries:{AF:"Afghanistan",AX:"\xC5land Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BQ:"Bonaire, Saint Eustatius and Saba",BA:"Bosnia-Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",vv:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, the Democratic Republic of the",CK:"Cook Islands",CR:"Costa Rica",CI:"C\xF4te d\u2019Ivoire",HR:"Croatia",CU:"Cuba",CW:"Curacao",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic of",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"North Korea",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People\u2019s Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia, the former Yugoslav Republic of",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States of",MD:"Moldova, Republic of",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory, Occupied",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"R\xE9union",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barth\xE9lemy",SH:"Saint Helena, Ascension and Tristan da Cunha",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin (French part)",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten (Dutch part)",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan, Province of China",TJ:"Tajikistan",TZ:"Tanzania, United Republic of",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela, Bolivarian Republic of",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},prep:function prep(){a.checkout.prepped||(a.styles.injectCSS(a.path+"/templates/checkout.css",!1,!0),a.checkout.prepped=!0)},begin:function begin(b,c){if(a.embedded)a.events.fire(a,"begincheckout",b);else if(a.checkout.prep(),a.storage.checkoutdata={stripe:!1,paypal:!1,shipping:!1,currency:!1,name:!1,email:!1,recurring:!1,origin:window.location.href,total:!1,transaction_message:!1},"https:"!==location.protocol&&!0!==b.testing&&(b.stripe=!1),b.recurring&&(a.storage.checkoutdata.recurring=!0),b.transaction_message&&(a.storage.checkoutdata.transaction_message=b.transaction_message),b.total&&(a.storage.checkoutdata.total=b.total),b.shipping){var d=[{id:"name",type:"text",placeholder:"Ship to name",required:!0},{id:"address1",type:"text",placeholder:"Shipping address 1",required:!0},{id:"address2",type:"text",placeholder:"Shipping address 2"},{id:"city",type:"text",placeholder:"City",required:!0},{id:"state",type:"text",placeholder:"State/Province/Region",required:!0},{id:"postalcode",type:"text",placeholder:"Postal code",required:!0}];if(b.stripe||b.paypal){var e="US";if(b.currency)switch(b.currency){case"GBP":e="GB";break;case"AUD":e="AU";break;case"JPY":e="JP";break;case"CAD":e="CA";break;case"NZD":e="NZ";break;case"HKD":e="HK";break;case"MXN":e="MX";break;case"NOK":e="NO";}d.push({id:"country",type:"select",options:a.checkout.countries,value:e}),b.recurring||"object"!==_typeof(b.shipping)||d.push({id:"shipping-region",type:"select",options:{"":"Select shipping region",r1:b.shipping.r1,r2:b.shipping.r2},required:!0}),d.push({id:"shipping-submit",type:"submit",text:"Set shipping info"}),"object"===_typeof(b.shipping)?a.userinput.getInput(d,"getshippingaddress","shipping"):a.userinput.getInput(d,"getshippingaddress","noshipping"),a.events.add(a,"userinput",function(d){"getshippingaddress"==d.detail["vv-userinput-type"]&&(a.storage.checkoutdata.shipping=d.detail,a.checkout.initiatepayment(b,c))})}else a.checkout.showerror()}else a.checkout.initiatepayment(b,c)},initiatepayment:function initiatepayment(b,c){if(b.stripe&&!b.paypal)a.stripe.generateToken(b.stripe,c);else if(!b.stripe&&b.paypal)a.storage.checkoutdata.paypal=!0,a.events.fire(a,"checkoutdata",a.storage.checkoutdata,c),a.overlay.reveal("<div class=\"vv-loading\"></div>");else if(b.stripe&&b.paypal){var d=document.createElement("div");d.className="vv-checkout-choose";var e=document.createElement("span"),f=document.createElement("span");e.innerHTML="Pay with PayPal",e.className="pay-pp",f.innerHTML="Pay with a credit card",f.className="pay-cc",a.events.add(e,"click",function(b){b.preventDefault(),b.stopPropagation(),a.storage.checkoutdata.paypal=!0,a.events.fire(a,"checkoutdata",a.storage.checkoutdata,c),a.overlay.reveal("<div class=\"vv-loading\"></div>")}),a.events.add(f,"click",function(d){d.preventDefault(),d.stopPropagation(),a.stripe.generateToken(b.stripe,c)}),d.appendChild(e),d.appendChild(f),a.overlay.reveal(d)}else a.checkout.showerror()},showerror:function showerror(){a.overlay.reveal("<div class=\"vv-checkout-error\">There are no valid payment types. Please add a payment connection. Check to make sure your site supports SSL (https) if you are using Stripe.</div>")}}})();